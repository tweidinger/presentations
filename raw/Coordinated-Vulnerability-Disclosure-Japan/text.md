# Vulnerability Disclosure 
#### How (not) to panic

---
	`whoami`
## Tillmann Weidinger
	- I press buttons
	- I have am a (lazy) bad developer but good engineer
	- I know what you did last summer

/assets/Clipboard.png
size: contain
title: CV
 
---

### Why This Talk? 
#### Help Each Other Out

- Help devs to get better and understand more about vulnerabilities and why they shouldn't panic when someone discovers some fault
- Help organizations to get better and handling disclosures and treating ethical hackers better
- Help ethical hackers to have it easier
- Potential for a series of security talks for specific vulnerabilities (name your areas and we find something together -> after the talk)


---
	## What is a Vulnerability?
	

What is a Vulnerability?

The human definition:

The quality or state of being exposed to the possibility of being attacked or harmed, either physically or emotionally.

The technical definition:

Vulnerabilities are flaws or weaknesses in a system's design, implementation, or management that can be exploited by a malicious actor to compromise its security. 

There are several kinds of vulnerabilities and bug classes. I will go through one example out of the wild and then go more into another vulnerability I disclosed to a Japanese company.
If you want to learn more about these different types and classes feel free to chat with me afterwards or request another presentation dedicated to this.
---
### Remote Code Execution (RCE)
```javascript
new c.default().start({ port: f, hostname: "0.0.0.0", pro: p, foo: m }).then(({ server: e, app: t }) => {
...
    t.post("/run-command", (e, t) =>
        i(void 0, void 0, void 0, function* () {
            const n = e.body.command;
            try {
                const e = yield (0, o.execAsync)(n, { cwd: u.default.getp() });
                t.json(e);
            } catch (e) {
                t.json(e);
            }
        })
    ),
...
```

	**`hostname: "0.0.0.0"`**
	Listen to anyone on the network
	**`o.execAsync`**
	Execute on host system via node shell execute
	**`e.body.command`**
	Execute this command from the request body

	`curl remote.server:1337/run-command --data '{"command": "whoami"}' -H "Content-Type: application/json"`
	`{"stdout":"root"}`


--- 
### How Do I Browse The Internet?
/assets/Clipboard 3.png

I am not the normal person just using my browser as I should. I tend to try to understand what the site or application is doing just out of pure curiosity.
So I tend to have the browser developer tools open that allows me to see what requests a site makes and to which services.

---
### How Does It Get Me In Trouble? 

I often stumble upon vulnerabilities by just looking at this console. My personal ethics then urge me to report this to whoever is responsible, so I have peace of mind and am able to use a site or application without knowing my data or other peoples data are in danger of being exposed.

---
### Why does this matter for this presentation?

I think using real world examples is the best way to learn and explain complicated topics and it will also help me to build a mostly cohesive story.

---
### The Job Search

Back in the end of last year I was looking for a new job and got referred to a recruiting agency by Karim.

As usual I had my developer tools open during registration and while looking at the job offers.

This is when I noticed something off.

---
### The Discovery
/assets/Screenshot 2025-05-21 at 15.23.45 1.png
size: contain

---

### The Issue
```sh
/api/user/12345678
```
```sh
/api/users
```

I noticed the recruiting website doing some calls to their API.
I was curious what this API would provide in terms of data and if they use proper authentication and authorization.

So as a first test I just browsed to their API endpoint.


I then decided to check other interesting endpoints of the API. One of them was `/api/users/` - I found this one by changing from `/user` to `/users` on a hunch.

Oh boy. My browser took several seconds to load and I already knew I was right.

What I found were all personal data of all users.

---
### The Full Data
```json
  "data": {
    "candidate": {
      "Id": "001****AF",
      "MasterRecordId": null,
      "Candidate_phase__c": "Reactivated",
      "Name": "****karim",
      "LastName": "****karim",
      "FirstName": "****karim",
      "PersonContactId": "00*****I",
      "Phone": "70*****79",
      "PersonEmail": "abd******x2@gmail.com",
      "LinkedIn_URL__pc": "https://www.linkedin.com/in/******/",
      "Address__pc": "6**-8***  ÂÖµ*Áúå******",
      "Visa_expiration_date__pc": "******",
      "Birth_Date__pc": "19******",
      "Entrance_Year_Month__pc": null,
      "Gender__pc": null,
      "GitHub_ID__pc": "https://github.com/*******",
      "Graduation_Year_Month__pc": "20***/**",
      "Last_University__pc": "Waseda University",
      "Latest_Degree__pc": "Master",
      "Major__pc": "Computer Science",
      "Job_Preference_Other__pc": null,
      "Job_Preference__pc": null,
      "JLPT__pc": "******",
      "Type_of_Visa__pc": "*******",
      "Nationality__pc": "********",
      "Self_Introduction_Summary__pc": null,
      "LastModifiedDate": "2024-12-24T00:30:42.000+0000",
      "Other_skill_certification_publication_PR__pc": null,
      "Company_name1__pc": "*****",
      "Company_name2__pc": "*****",
      "Company_name3__pc": "*****",
      "Company_name4__pc": null,
      "Start_date1__pc": "2022/06",
      "Start_date2__pc": "2020/04",
      "Start_date3__pc": "2014/12",
      }
```

Karim agreed to usage of his data for the presentation. I censored data on my own with `****` after extracting from the API.

---
### What Now?

So I had access to around 15 thousand people's data and the back of my head going into panic mode.

	- Do I report this?
	- How do I report this?
	- Can I get sued?
	- Is this type of hacking illegal in Japan?

---
### Do I Report?
	Yes!
I got into this and my ethics tell me: "report it now!!!", but my head tells me "I heard about things being different here".
But I am determined to report, so let's just skip to yes.

---

/assets/Clipboard 4.png
size: contain

Thankfully someone out there had answers to the last few questions.
Thanks to the Dutch embassy, their lawyers and especially Chris van 't Hof for publishing all of their efforts. I can recommend watching his talk and reading the full publication.
I'll provide a link on the last slide.

---
### The Japanese Law
	Penal Code (ÂàëÊ≥ï Keih≈ç)
	"General criminal law‚Äù


	Act on Prohibition of Unauthorized Access
	
	- Unauthorized computer access **(3 yr / 1M JPY)**
	- Obtaining or wrongfully storing someone else‚Äôs credentials, facilitating unauthorized computer access and illicitly requesting the input of credentials **(1 yr / 0.5M JPY**




There is the Penal Code (Criminal Law) and the Case Law (Pre-existing verdicts).

The apparently most used act is mentioned above and seems to be applied on the traditional "hacking" cases. There are more laws that may be relevant but this seems to be the most used one.

There seem to be not enough cases for the case law to be referred to much but in some cases public disclosure without allowing proper time to fix was punishable.

So yes, first conclusion is that it is kinda illegal. Hmm that's bad.
Thankfully there is more nuanced information in the official Japanese guidelines for vulnerability disclosure. Yes, Japan has guidelines for this since the early 2000's.

---
### Was I Really Allowed To Hack?

	In a case where a user of a web application accesses the application normally by logging in using valid procedures and where the existence of a vulnerability can be inferred by observing the content of the communication between the browser and the server

	In a case where a user replaces a string of numbers in a URL ... as such result, the user accidentally accesses a website that is presumed to
	be inaccessible according to social standards.

I am citing a minified part of the guidelines that showcases legal hacking - or at least not illegal hacking.

This showcases that what I did with the url manipulation was kinda falling in these categories but the first example of the remote code execution would've been illegal if that would have been a Japanese entity or server.

There are more examples and nuanced takes so I just recommend to read the full guidelines.

So assuming I am not getting sued and jailed. What next?
---
### How Do I Report?
/assets/Clipboard 5.png
size: contain

Yes, Japan has a flowchart.
I wasn't aware of this on my initial disclosure so I didn't follow the happy path of submitting the issue in the web application to the AIST (National Institute of Advanced Industrial Science and Technology).

So what you should do is reporting web vulnerabilities to the AIST and software and hardware vulnerabilities to the JP CERT.

I didn't, so I can't tell you much about how it works with them. What I did was directly reaching out to the recruiting agency. They reacted in a proper way after I found an inbox where they check emails (spoiler, their CEOs mail). They thanked me and published a note on their website and later informed their users via email about the issue.

---
### Let's Switch Sides
	Suddenly things are burning!

So up 'til this point I explained how disclosure works from a perspective of an ethical hacker.
Most people here are on the productive side and actually build things instead of breaking things.
So imagine you have your normal working day and suddenly you hear your email client making a noise or you check if there has been a response in your inbox from someone you are waiting for.

But all you find is this:

---
### Vulnerability Disclosure
#### Unauthenticated Leak of **ALL** Users Personal Identifiable Information
/assets/Clipboard 7.png
size: contain


What would you do first?
Panic?
Ignore?
Read?

I am also on the receiving end at my day job and in the open source project I am involved in.

I can say from experience that 90% of disclosures saying **criticial vulnerabilty** are neither critical nor real vulnerabilities.

So my first reaction is skepticism and carefully reading the email. After figuring out if the content is neither bullshit nor hallucinated AI content I involve others to be aware of a potential threat and go from there.

If I call bullshit I either ignore the email or kindly respond that the submission was not applicable and sometimes even thank them for at least trying to make the world a better place.

Before we talk about what the recommended way to handle valid disclosures is, I have to talk about something uncomfortable that is definitely not best practice. 

---

### The Blame Game
/assets/Clipboard 6.png


I have observed that whenever there is a vulnerability reported there is at least one person in the team or manager involved who starts the blame game.

The blame game implies that there is one single person at fault and I could observe people getting fired for mistakes around vulnerabilities to satisfy the collective and to get false closure. That is not exclusive to security vulnerabilities but I have seen it happen more often than for usability bugs.

I just want to make sure that we are on the same page. There is usually no single cause or person responsible and it never improves the status quo to prioritize the finger pointing over learning from failure. That is probably common knowledge but it seems to get lost when emotions and money is involved.
 
---
So let's talk about keywords related to good handling of vulnerability reports.

#### Communicate
	Talk To Your Peers

Make sure that everyone who is involved internally knows the status and impact of the vulnerability.

#### Stay Technical
	Focus On Fixing

Do not play the blame game and try to keep it to technical solutions.

#### Investigate
	Actively Exploited?

If you logging is mature enough you should be able to figure out if the issue was previously exploited and if you need to warn customers immediately.

#### Prioritize
	Clarify Impact

Not all issues have the same impact or likelihood of exploitation but don't put all of them in the backlog if they seem not like a 10/10 severity scored issue.

#### Validate
	See It For Yourself

If you get submissions try to reproduce them to gain knowledge and to make sure you are not waking up your colleagues over nothing.

#### Acknowledge
	Be Transparent 

Share infos publicly once fixed,
Keep the submitter in the loop and offer financial or public acknowledgment for their work if you are able to.

---
### What Can I Implement At Work?

#### Security.txt
	‚úÖ Super Easy
```
Contact: https://hackerone.com/ed
Expires: 2026-03-27T00:00:00.000Z
Acknowledgments: https://hackerone.com/ed/thanks
Preferred-Languages: en, fr, de
Canonical: https://securitytxt.org/.well-known/security.txt
Policy: https://hackerone.com/ed?type=team&view_policy=true
```

#### Public Disclosure Policy
	üòê Moderate
	Requires Management&Legal

#### Internal Disclosure Process
	‚úÖ Easy
	Start A Simple Document (Who?When?What?)

#### Secure Software Development Guidelines
	üòµ‚Äçüí´ Complicated
	Pre-Disclosure Improvement


---
### What About Bug Bounty Programs?

I didn't mention the common method of bug bounties above as I have opinions on this and want to make sure you understand when you could need this and when it is actually counter-productive.

Bug bounties were invented with the goal to improve the situation of independent researchers that face(d) the decision of selling exploits for profit or giving them for free to the companies that are affected.

Initially this improved the situation of these researchers as they could be sure that a company wouldn't sue them and even compensate them for their work. It made it feasible to not sell your exploits to shady vendors if you made a living from reporting security vulnerabilities.

It then evolved. Probably due to the capitalistic system we are part of or maybe because of other reasons. Suddenly companies saw no need for internal security QA, as they could now leverage the community for this and at the same time save face, as they are participating in the greater good and could communicate this with their customers.

The market growth also led to another thing that wasn't intended. Suddenly AI was auto submitting hallucinated vulnerabilities and the workload of triage increased even more.

Which leads to today's situation. Bug bounty programs are abused by companies as cheap QA, abused by other companies to make money with automated submissions and abused by researchers to blackmail companies into fame.

So when do you actually need a bug bounty program for your company?

The answer is yes if you are a company between Fortune 500 and 500+ employees and have a consumer facing product.

If your company is big enough you should be able to employ your own team to handle submissions and coordinate internally. If you are a small startup or mid sized company the amount of submissions shouldn't warrant a full blown third party vendor and it should be feasible to have someone part time handle things.

There are also other trade offs like the bug bounty program secretly selling or abusing unpatched vulnerabilities - it has happened in the past so not a theoretical threat at all.

---
### Sources and Learnings

/assets/cvd-japan-talk.png
size: contain
	Talk: Coordinated Vulnerability Disclosure in Japan

/assets/overview.png
size: contain
	Japan CVD Flow Overview

/assets/cvd.png
size: contain
	Paper CVD in Japan

/assets/cvd-policy-creation.png
size: contain
	Official Dutch CVD Policy Creation Guidelines


